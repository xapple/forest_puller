<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.1" />
<title>forest_puller.tables.max_area_over_time API documentation</title>
<meta name="description" content="Written by Lucas Sinclair and Paul Rougieux â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>forest_puller.tables.max_area_over_time</code></h1>
</header>
<section id="section-intro">
<p>Written by Lucas Sinclair and Paul Rougieux.</p>
<p>JRC Biomass Project.
Unit D1 Bioeconomy.</p>
<p>Typically you can use this class like this:</p>
<pre><code>&gt;&gt;&gt; from forest_puller.tables.max_area_over_time import max_area
&gt;&gt;&gt; print(max_area.df)
</code></pre>
<p>To export the table:</p>
<pre><code>&gt;&gt;&gt; from forest_puller.tables.max_area_over_time import max_area
&gt;&gt;&gt; print(max_area.save())
</code></pre>
<p>To export the table for the publication:</p>
<pre><code>&gt;&gt;&gt; from forest_puller.tables.max_area_over_time import max_area_pub
&gt;&gt;&gt; print(max_area_pub.save())
</code></pre>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#!/usr/bin/env python3
# -*- coding: utf-8 -*-

&#34;&#34;&#34;
Written by Lucas Sinclair and Paul Rougieux.

JRC Biomass Project.
Unit D1 Bioeconomy.

Typically you can use this class like this:

    &gt;&gt;&gt; from forest_puller.tables.max_area_over_time import max_area
    &gt;&gt;&gt; print(max_area.df)

To export the table:

    &gt;&gt;&gt; from forest_puller.tables.max_area_over_time import max_area
    &gt;&gt;&gt; print(max_area.save())

To export the table for the publication:

    &gt;&gt;&gt; from forest_puller.tables.max_area_over_time import max_area_pub
    &gt;&gt;&gt; print(max_area_pub.save())
&#34;&#34;&#34;

# Built-in modules #

# Internal modules #
from forest_puller        import cache_dir
from forest_puller.tables import Table
from forest_puller.common import country_codes

# First party modules #
from plumbing.cache  import property_cached

# Third party modules #
import pandas

###############################################################################
class MaxArea(Table):
    &#34;&#34;&#34;
    Display, for each source, and for each country, the maximum forest area
    over time (usually this occurs in the last year of the dataset but not always).
    Data sources are displayed as different columns, and countries as rows.
    Values are in hectares.
    &#34;&#34;&#34;

    # Parameters #
    short_name       = &#39;max_area&#39;
    float_format_tex = &#39;split_thousands&#39;

    # Extra formatting #
    upper_columns = True

    # Pick sources to include #
    source_names = [&#39;ipcc&#39;, &#39;soef&#39;, &#39;faostat&#39;, &#39;hpffre&#39;, &#39;fra&#39;]

    #----------------------------- Data sources ------------------------------#
    @property_cached
    def df(self):
        # Import the data from the area graph #
        from forest_puller.viz.area_comp import area_comp_data
        # Put each dataframe in a list #
        dfs = [getattr(area_comp_data, source) for source in self.source_names]
        # Function to group each one by country and do max on area #
        fn = lambda d: d.groupby(&#39;country&#39;).aggregate({&#39;area&#39;: &#39;max&#39;})
        # Apply that function to each source #
        dfs = [fn(df) for df in dfs]
        # Reset index #
        dfs = [df.reset_index() for df in dfs]
        # Rename the column to include the source #
        df_to_names = zip(dfs, self.source_names)
        dfs = [df.rename(columns={&#39;area&#39;: name}) for df, name in df_to_names]
        # Make a list of countries we want included #
        codes = [iso2 for iso2 in country_codes[&#39;iso2_code&#39;]]
        # Start with an empty dataframe #
        result = pandas.DataFrame(codes, columns=[&#39;country&#39;])
        # Join each data source #
        for df in dfs: result = result.left_join(df, on=&#39;country&#39;)
        # Set the index #
        result = result.set_index(&#39;country&#39;)
        # Return #
        return result

###############################################################################
class MaxAreaPublication(MaxArea):
    short_name   = &#39;max_area_pub&#39;
    source_names = [&#39;ipcc&#39;, &#39;soef&#39;, &#39;faostat&#39;, &#39;hpffre&#39;, &#39;fra&#39;]

###############################################################################
# Pick destination #
export_dir = cache_dir + &#39;tables/&#39;

# Create a singleton for all sources #
max_area = MaxArea(base_dir = export_dir)

# Create a singleton for the manuscript #
max_area_pub = MaxAreaPublication(base_dir = export_dir)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="forest_puller.tables.max_area_over_time.MaxArea"><code class="flex name class">
<span>class <span class="ident">MaxArea</span></span>
<span>(</span><span>parent=None, base_dir=None, short_name=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Display, for each source, and for each country, the maximum forest area
over time (usually this occurs in the last year of the dataset but not always).
Data sources are displayed as different columns, and countries as rows.
Values are in hectares.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MaxArea(Table):
    &#34;&#34;&#34;
    Display, for each source, and for each country, the maximum forest area
    over time (usually this occurs in the last year of the dataset but not always).
    Data sources are displayed as different columns, and countries as rows.
    Values are in hectares.
    &#34;&#34;&#34;

    # Parameters #
    short_name       = &#39;max_area&#39;
    float_format_tex = &#39;split_thousands&#39;

    # Extra formatting #
    upper_columns = True

    # Pick sources to include #
    source_names = [&#39;ipcc&#39;, &#39;soef&#39;, &#39;faostat&#39;, &#39;hpffre&#39;, &#39;fra&#39;]

    #----------------------------- Data sources ------------------------------#
    @property_cached
    def df(self):
        # Import the data from the area graph #
        from forest_puller.viz.area_comp import area_comp_data
        # Put each dataframe in a list #
        dfs = [getattr(area_comp_data, source) for source in self.source_names]
        # Function to group each one by country and do max on area #
        fn = lambda d: d.groupby(&#39;country&#39;).aggregate({&#39;area&#39;: &#39;max&#39;})
        # Apply that function to each source #
        dfs = [fn(df) for df in dfs]
        # Reset index #
        dfs = [df.reset_index() for df in dfs]
        # Rename the column to include the source #
        df_to_names = zip(dfs, self.source_names)
        dfs = [df.rename(columns={&#39;area&#39;: name}) for df, name in df_to_names]
        # Make a list of countries we want included #
        codes = [iso2 for iso2 in country_codes[&#39;iso2_code&#39;]]
        # Start with an empty dataframe #
        result = pandas.DataFrame(codes, columns=[&#39;country&#39;])
        # Join each data source #
        for df in dfs: result = result.left_join(df, on=&#39;country&#39;)
        # Set the index #
        result = result.set_index(&#39;country&#39;)
        # Return #
        return result</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="forest_puller.tables.Table" href="index.html#forest_puller.tables.Table">Table</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="forest_puller.tables.max_area_over_time.MaxAreaPublication" href="#forest_puller.tables.max_area_over_time.MaxAreaPublication">MaxAreaPublication</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="forest_puller.tables.max_area_over_time.MaxArea.float_format_tex"><code class="name">var <span class="ident">float_format_tex</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="forest_puller.tables.max_area_over_time.MaxArea.short_name"><code class="name">var <span class="ident">short_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="forest_puller.tables.max_area_over_time.MaxArea.source_names"><code class="name">var <span class="ident">source_names</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="forest_puller.tables.max_area_over_time.MaxArea.upper_columns"><code class="name">var <span class="ident">upper_columns</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="forest_puller.tables.max_area_over_time.MaxArea.df"><code class="name">var <span class="ident">df</span></code></dt>
<dd>
<div class="desc"><p>If you see the current source code in a seemingly unrelated part of
an auto-generated documentation, it means the program making the
documentation was unable to correctly traverse a decorated property.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    &#34;&#34;&#34;
    If you see the current source code in a seemingly unrelated part of
    an auto-generated documentation, it means the program making the
    documentation was unable to correctly traverse a decorated property.
    &#34;&#34;&#34;
    # For debugging purposes #
    if False: print(&#34;-&gt; property cached `%s`&#34; % instance)
    # If called from a class #
    if instance is None: return self
    # Does a cache exist for this instance? #
    self.check_cache(instance)
    # Is the answer in the cache? #
    if self.name in instance.__cache__: return instance.__cache__[self.name]
    # If not we will compute it #
    if inspect.isgeneratorfunction(self.func): result = tuple(self.func(instance))
    else:                                      result = self.func(instance)
    # Let&#39;s store the answer for later #
    instance.__cache__[self.name] = result
    # Return #
    return result</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="forest_puller.tables.Table" href="index.html#forest_puller.tables.Table">Table</a></b></code>:
<ul class="hlist">
<li><code><a title="forest_puller.tables.Table.path" href="index.html#forest_puller.tables.Table.path">path</a></code></li>
<li><code><a title="forest_puller.tables.Table.split_thousands" href="index.html#forest_puller.tables.Table.split_thousands">split_thousands</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="forest_puller.tables.max_area_over_time.MaxAreaPublication"><code class="flex name class">
<span>class <span class="ident">MaxAreaPublication</span></span>
<span>(</span><span>parent=None, base_dir=None, short_name=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Display, for each source, and for each country, the maximum forest area
over time (usually this occurs in the last year of the dataset but not always).
Data sources are displayed as different columns, and countries as rows.
Values are in hectares.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MaxAreaPublication(MaxArea):
    short_name   = &#39;max_area_pub&#39;
    source_names = [&#39;ipcc&#39;, &#39;soef&#39;, &#39;faostat&#39;, &#39;hpffre&#39;, &#39;fra&#39;]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="forest_puller.tables.max_area_over_time.MaxArea" href="#forest_puller.tables.max_area_over_time.MaxArea">MaxArea</a></li>
<li><a title="forest_puller.tables.Table" href="index.html#forest_puller.tables.Table">Table</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="forest_puller.tables.max_area_over_time.MaxAreaPublication.short_name"><code class="name">var <span class="ident">short_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="forest_puller.tables.max_area_over_time.MaxAreaPublication.source_names"><code class="name">var <span class="ident">source_names</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="forest_puller.tables.max_area_over_time.MaxArea" href="#forest_puller.tables.max_area_over_time.MaxArea">MaxArea</a></b></code>:
<ul class="hlist">
<li><code><a title="forest_puller.tables.max_area_over_time.MaxArea.df" href="#forest_puller.tables.max_area_over_time.MaxArea.df">df</a></code></li>
<li><code><a title="forest_puller.tables.max_area_over_time.MaxArea.path" href="index.html#forest_puller.tables.Table.path">path</a></code></li>
<li><code><a title="forest_puller.tables.max_area_over_time.MaxArea.split_thousands" href="index.html#forest_puller.tables.Table.split_thousands">split_thousands</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="forest_puller.tables" href="index.html">forest_puller.tables</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="forest_puller.tables.max_area_over_time.MaxArea" href="#forest_puller.tables.max_area_over_time.MaxArea">MaxArea</a></code></h4>
<ul class="">
<li><code><a title="forest_puller.tables.max_area_over_time.MaxArea.df" href="#forest_puller.tables.max_area_over_time.MaxArea.df">df</a></code></li>
<li><code><a title="forest_puller.tables.max_area_over_time.MaxArea.float_format_tex" href="#forest_puller.tables.max_area_over_time.MaxArea.float_format_tex">float_format_tex</a></code></li>
<li><code><a title="forest_puller.tables.max_area_over_time.MaxArea.short_name" href="#forest_puller.tables.max_area_over_time.MaxArea.short_name">short_name</a></code></li>
<li><code><a title="forest_puller.tables.max_area_over_time.MaxArea.source_names" href="#forest_puller.tables.max_area_over_time.MaxArea.source_names">source_names</a></code></li>
<li><code><a title="forest_puller.tables.max_area_over_time.MaxArea.upper_columns" href="#forest_puller.tables.max_area_over_time.MaxArea.upper_columns">upper_columns</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="forest_puller.tables.max_area_over_time.MaxAreaPublication" href="#forest_puller.tables.max_area_over_time.MaxAreaPublication">MaxAreaPublication</a></code></h4>
<ul class="">
<li><code><a title="forest_puller.tables.max_area_over_time.MaxAreaPublication.short_name" href="#forest_puller.tables.max_area_over_time.MaxAreaPublication.short_name">short_name</a></code></li>
<li><code><a title="forest_puller.tables.max_area_over_time.MaxAreaPublication.source_names" href="#forest_puller.tables.max_area_over_time.MaxAreaPublication.source_names">source_names</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.1</a>.</p>
</footer>
</body>
</html>